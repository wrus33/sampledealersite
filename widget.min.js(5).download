"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){_pxam=window._pxam||[];var i,n=e("#recentVehicleTemplate").html(),r=e("#savedVehicleTemplate").html(),a=e("#priceAlertTemplate").html(),s=e("#incentivesTemplate").html(),o=!1,l=!1,c=!1,d=window.DDC.Widgets.MyCars.WIDGET_USER_EVENT_CONSTANTS.FORM,f={notEmpty:/^\s*\S+.*/,currency:/\B(?=(\d{3})+(?!\d))/g,size:/size-(\d*)-(\d*)/,text:/^[a-z ,.'-]+$/i,email:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i,password:/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])[\w!"#\$%&'\(\)\*\+,-\.\/:;<=>\?@\[\]\^_`\{\|}~\\]{6,}$/},u="<div>Failed to load component, please try again</div>",m=e("#recentVehicleTemplate").length>0?{recentCars:n?_.template(n,null,{variable:"data"}):"",savedCars:r?_.template(r,null,{variable:"data"}):"",priceAlerts:a?_.template(a,null,{variable:"data"}):"",incentives:s?_.template(s,null,{variable:"data"}):""}:{},p={recentCars:{statusType:"RECENTLY_VIEWED",pageSize:"20"},savedCars:{statusType:"SAVED",pageSize:"40"},priceAlerts:{statusType:"NOTIFICATIONS_ENABLED",notificationTypes:"PRICE_CHANGE,NEW_INCENTIVES",notificationStatus:"UNREAD",sortFields:"latestNotifications.PRICE_CHANGE.notifyDate:-1",pageSize:"40"}},v=90,g="drinteraction",h={profile:{},recentCars:[],savedCars:[],priceAlerts:[]},y={navbar:e(".mycars.mycars-integration-navbar").length>0},b=e(".mycars-default .ddc-toolbar"),I=b.find(".mycars"),w=e(".smartbar"),C=I.find(".login").data("key","login"),E=I.find(".recent-cars").data("key","recentCars"),D=I.find(".saved-cars").data("key","savedCars"),P=I.find(".price-alerts").data("key","priceAlerts"),T=I.data("ismobile"),N=e(".digital-retailing-toolbox").length?!0:!1,k=e("[data-digital-retail-summary-label]"),S={vehicleOfInterest:"vehicleOfInterest",trade:"",accessories:"",payment:"",finance:"",prequal:"",reserve:"",protect:"",lifestyle:"",testdrive:""},O=!1,A=I.length>0?window.location.protocol+"//"+I.data("groupdomain"):"",R=I.data("hasgroup")||t.siteSettings.isSecureLoginEnabled&&!t.siteSettings.isDomainSSLEnabled,L=I.data("vdpvehicleid"),U=A.substring(A.indexOf(".")),x=!1,M=!1,V="",F=e("body").hasClass("ie8")||e("body").hasClass("ie9")?"keyup click":"keyup blur click",G=T?I.find(".login").data("login-href"):I.find(".login > a").data("login-href"),W=T?I.find(".login").data("register-href"):I.find(".login > a").data("register-href"),H=T?I.find(".login").data("login-intercept-href"):"",B=""!==H,j=b.parents("[data-widget-name]").data("widget-name"),q=b.parents("[data-widget-id]").data("widget-id"),Y=function(){_pxam.push({type:"event",eventType:"user.loaded",userProfileId:h.profile.profileId,universalUserId:h.profile.universalUserId,userType:"DDC"==h.profile.source||"FACEBOOK"==h.profile.source?"registered":"anonymous"})},Q=function(e){var t;t=void 0===e?"DDC"==h.profile.source||"FACEBOOK"==h.profile.source?"registered":"anonymous":e,_pxam.push({type:"event",eventType:"user.registered",userProfileId:h.profile.profileId,universalUserId:h.profile.universalUserId,userType:t})},z=function(e,t){var i;i=void 0===t?e.statuses.NOTIFICATIONS_ENABLED?!0:!1:t,_pxam.push({type:"event",eventType:"vehicle.saved",userProfileId:h.profile.profileId,universalUserId:h.profile.universalUserId,userType:"DDC"==h.profile.source||"FACEBOOK"==h.profile.source?"registered":"anonymous",vehicleType:2==e.attributes.condition?"new":"used",make:e.attributes.make,model:e.attributes.model,bodyStyle:e.attributes.bodyStyle,vin:e.attributes.vin,year:e.attributes.year,vehicleId:e.itemUUID,stockNumber:e.attributes.stockNumber,notificationsEnabled:i})},J=function(){var e="mycars",t={expires:365,path:"/"};return function(i,n){for(var r={},a=jQuery.cookie(e)||"",s=a.split(";"),o=0;o<s.length;o++){var l=s[o];if(l){var c=l.split(":");r[c[0]]=c[1]}}if(void 0!==n||i&&"object"==("undefined"==typeof i?"undefined":_typeof(i))){void 0!==n?r[i]=n:jQuery.extend(r,i),a="";for(o in r)a+=o+":"+r[o]+";";jQuery.cookie(e,a,t)}return i&&"string"==typeof i?r[i]:r}}(),$=function(t,i,n,r,a){i=i||"savedVehicleCount: "+h.savedCars.length,n=n||"recentlyViewedCount: "+h.recentCars.length,e(document).trigger("trackEvent",[{widgetName:"mycars-"+t,eventName:i,data:n,noninteraction:r},a])},K=function(t){var i=t.element,n=t.elementCTA,r=t.action,a=t.result,s=void 0===a?"":a,o=t.widgetState,l=void 0===o?"default":o,c=t.value,d=t.nonInteractive,f=void 0===d?!1:d,u=t.optionalData,m=void 0===u?{}:u;if(!i)throw new Error("trackWidgetUserEvent - element must be defined");if(!r)throw new Error("trackWidgetUserEvent - action must be defined");e(document).trigger("trackEvent",[{event:"widgetUserEvent",element:i,elementCTA:n,action:r,result:s,widgetName:j,widgetId:q,widgetState:l,value:c,nonInteractive:f===!0||"TRUE"===f?"TRUE":"FALSE"},m])},Z=function(){var t=E.find(".count").css("background-color"),i=e("#mycars-toolbar").attr("data-color");return function(e,n,r){r?e.addClass("alert-color").animate({backgroundColor:"#"+i},"slow").delay(1e3).queue(function(i){e.removeClass("alert-color").animate({backgroundColor:t},"slow"),i()}).find("div").css({marginTop:"30px"}).animate({marginTop:"0"},"slow","easeOutBounce").html(n||"0"):e.find("div").html(n||"0")}}(),X=function(t){t.each(function(){var t=e(this),i=_.groupBy(h.savedCars,"itemUUID"),n=i[t.attr("data-id")],r=n&&_.has(n[0].statuses,"NOTIFICATIONS_ENABLED"),a=t.hasClass("mycars-save-btn"),s=t.hasClass("mycars-saved-btn"),o=t.hasClass("mycars-add-alert-btn"),l=t.hasClass("mycars-alerts-isset");t.addClass("hide"),(a&&!n||s&&n||o&&!r||l&&r)&&t.removeClass("hide")})},et=function(){e(".mycars-favorites").length>0&&window.location.reload(!0)},tt=function(){y.navbar&&(e(".mycars > .menu.login").addClass("menu-show"),(h.profile.email||e(".mycars > .menu-has-count").length>0)&&e(".mycars > .menu").addClass("menu-show"))},it=function(){return"https:"!=window.location.protocol&&t.siteSettings.isSecureLoginEnabled&&window.open(t.createSecureDdcDomainRedirect(window.location.href),"_self"),!1},nt=function(t){if(T)_.each(t,function(t){X(e(".mycars-btn")),Ot(t)});else{var i=J();_.each(t,function(t){var n=t.data("key"),r=h[n].length;r>0?t.addClass("menu-has-count"):t.removeClass("menu-has-count"),tt(),i[n]!=r&&(J(n,r),Z(t.find(".count"),r,!0)),t.hasClass("selected")&&Ot(t),t==D&&X(e(".mycars-btn").not(".mycars .mycars-btn"))})}},rt=function(t,i,n,r){var a=window.DDC.getSiteProperty("Tier2Region");return a&&(r=r||{},r.Tier2Region=a),e.ajax({type:"GET",url:"/apis/mycars/v1/profiles"+(n?"/"+n:""),cache:!1,data:r,contentType:"application/json",success:function(e){t(e)},error:i})},at=function(e,t){t=t||function(){},h.profile.profileId?rt(function(i){h[e.data("key")]=i.results,nt([e]),t()},function(){h[e.data("key")]=[],nt([e]),t()},h.profile.profileId+"/vehicles",p[e.data("key")]):(h[e.data("key")]=[],nt([e]),t())},st=function(i){var n=h.profile.email;if(pt(n?!0:!1),O&&t.siteSettings.isSecureLoginEnabled&&"http:"===window.location.protocol&&it(),void 0===t.getUrlParams().referringPage&&di(),T?(e("body")[n?"addClass":"removeClass"]("logged-in"),e(".welcome").html(n?t.i18n.getLabel("WELCOME")+" "+n:"")):b[n?"addClass":"removeClass"]("logged-in"),C.find("> a .label").html(n?t.i18n.getLabel("WELCOME")+"<br /> "+n:t.i18n.getLabel("LOG_IN")),y.navbar){C.find("> a .label").html(t.i18n.getLabel(N&&O?"ACCOUNT":n&&O?"LOGGED_IN":"LOG_IN"));var r=C.find(".logout-link").children();C.find(".logout-link").text(t.i18n.getLabel("YOU_ARE_LOGGED_IN_AS")+" "+n+". ").append(r)}w.find(".info")[n?"addClass":"removeClass"]("hide");var a={recent:!1,saved:!1,alerts:!1},s=function(e){a[e]=!0,_.every(a)&&(i||function(){})()};Y(),at(E,_.partial(s,"recent")),at(D,_.partial(s,"saved")),at(P,_.partial(s,"alerts")),T&&!M&&(t.getUrlParams().hasOwnProperty("_mycarsTrigger")&&e(window.document).find("."+t.getUrlParams()._mycarsTrigger).not(".hide").trigger("click"),M=!0),e.publish("mycars-loaded")},ot=function(e,t){Ct("login",{profileId:e},function(e){h.profile=e,st(function(){$("login")})},{401:function(){$("login-unsuccessful","not-registered")}}),(t||function(){})()},lt=function(e,i){t.messageIframe("#myCarsMessageFrame",e,i)},ct=function(){lt({action:"setCookie",cookieName:"userProfileId",cookieData:h.profile.profileId,cookieExpireDays:v},A)},dt=function(){lt({action:"setCookie",cookieName:"userId",cookieData:h.profile.universalUserId,domain:U,cookieExpireDays:v},A)},ft=function(){lt({action:"setCookie",cookieName:g,cookieData:!0},A)},ut=function(){lt({action:"invalidateCookie",cookieName:"userProfileId",cookieData:"INVALID",cookieExpireDays:v},A),lt({action:"invalidateCookie",cookieName:g,cookieData:"INVALID"},A)},mt=function(t){if(t.origin===A){var i=JSON.parse(t.data),n=e.cookie("userId"),r=e.cookie("userProfileId");h.profile.universalUserId=n?n:null,h.profile.profileId=r?r:null,"cookieread"===i.result&&vt(i),"logoutcookie"===i.result&&gt(i,r),"rewritecookie"===i.result&&ht(i),"facebooklogin"===i.result&&yt(i),i.result&&"notfound"!==i.result||bt(i,n,r)}},pt=function(i){O=i,e.publish(O?"mycars-logged-in":"mycars-logged-out"),t.Widgets.MyCars.ORIGIN_API&&t.Widgets.MyCars.ORIGIN_API.sendUserLoginStatusApiUpdate()},vt=function(i){"userProfileId"===i.cookieName&&i.cookieData&&(L?(h.profile.profileId=i.cookieData,x||(ot(i.cookieData,function(){Gt(L)}),x=!0)):x||(ot(i.cookieData),x=!0)),"userId"===i.cookieName&&e.cookie("userId",i.cookieData,{path:"/"}),i.cookieName===g&&t.siteSettings.isSecureLoginEnabled&&"http:"===window.location.protocol&&it()},gt=function(t,i){if("userProfileId"===t.cookieName){var n=function(){x||(e.publish("mycars-user-logging-out"),Ct("create",{source:"ANONYMOUS"},function(e){h.profile=e,L?(Gt(L,function(){st()}),R&&h.profile.profileId&&ct()):(h.profile.email=null,h.profile.profileId=null,st())}),x=!0)};i?Ct("logout",null,function(){n(),null===sessionStorage.getItem("groupUserProfileIdProcessed")&&(sessionStorage.setItem("groupUserProfileIdProcessed",!0),et())}):n()}"userId"===t.cookieName&&wt({},function(e){h.profile.universalUserId=e.id?e.id:null,dt()})},ht=function(e){"userProfileId"===e.cookieName&&h.profile.profileId&&ct(),"userId"===e.cookieName&&h.profile.universalUserId&&dt()},yt=function(t){h.profile.email||Ct("login",{email:t.fbprofile.email},function(t){h.profile=t,T&&e(".ddc-mobile-slidein-content").find(".active-overlay").removeClass("active-overlay"),st(function(){$("login"),x=!0,dt(),R&&ct(),et()})},{401:function(){$("login-unsuccessful","not-registered"),Ct("create",{source:"FACEBOOK",email:t.fbprofile.email,firstName:t.fbprofile.first_name,lastName:t.fbprofile.last_name},function(e){h.profile=e,st(function(){$("register"),x=!0,R&&ct(),et(),Q("registered")})})}})},bt=function(e,t,i){"userId"===e.cookieName&&(t||wt({},function(e){h.profile.universalUserId=e.id?e.id:null,dt()})),R&&"userProfileId"===e.cookieName&&(L?i?x||(rt(function(e){h.profile=e.length>0?e[0]:{},Gt(L,function(){st(function(){ct()})})}),x=!0):x||(Ct("create",{source:"ANONYMOUS"},function(e){h.profile=e,Gt(L,function(){st(),ct()})}),x=!0):x||(rt(function(e){h.profile=e.length>0?e[0]:{},st()}),x=!0))},It=function(){rt(function(e){h.profile=e.length>0?e[0]:{},R||(L?h.profile.profileId?Gt(L,function(){st(function(){dt()}),x=!0}):Ct("create",{source:"ANONYMOUS"},function(e){h.profile=e,Gt(L,function(){st(function(){dt()}),x=!0})}):(st(),x=!0))})},wt=function(t,i,n,r){return e.ajax({type:"POST",url:"/apis/mycars/v1/users"+(r?"/"+r:""),data:JSON.stringify(t),dataType:"json",contentType:"application/json",success:function(e){i(e)},error:function(e){errorHandlers&&errorHandlers[e.status]&&errorHandlers[e.status]()}})},Ct=function(i,n,r,a,s){var o=window.DDC.getSiteProperty("Tier2Region"),l="";o&&(l+="?Tier2Region="+o),e.ajax({type:"POST",url:"/apis/mycars/v1/profiles"+(s?"/"+s:"")+l,data:JSON.stringify(n),dataType:"json",contentType:"application/json",beforeSend:function(e){e.setRequestHeader("MyCarsAction",i||"")},success:function(e){r&&r(e)},error:function(e){if(a){if(a[e.status])return void a[e.status]();if(a["*"])return void a["*"]()}t.isLive||"object"!=("undefined"==typeof console?"undefined":_typeof(console))||console.log("ERROR: Ajax post returned a status of: "+e.status)}})},Et=function(e){T||(jQuery(window.document).off("click.mycars"),I.add(".smartbar").find("> .selected").not(e).removeClass("selected").removeClass("recently-saved").find(".popup").removeClass("show-confirm"))},Dt=function(t,i){i=i||!1;var n=setInterval(function(){var r=e(document.activeElement);!i&&r&&r.is("iframe")?(clearInterval(n),Et()):t.hasClass("selected")?r.is("iframe")||(i=!1):clearInterval(n)},250);e(window.document).on("click.mycars",function(e){!t.is(e.target)&&t.has(e.target).length<1&&(clearInterval(n),Et())})},Pt=function(t){var i;i=-1!==t.indexOf("#")?e(t):T?e(".active-overlay ."+t+"-content form"):I.find(".menu.selected ."+t+"-content form");var t="create"==t?"register":t,n=!0,r=i.find("[type=submit]");r.addClass("disabled").attr("disabled",!0),i.find("input[type=text], input[type=email], input[type=password]").each(function(){var i=e(this),r=i.val().replace(/^\s+|\s+$/g,""),a=f.text;switch(i.attr("type")){case"email":a=f.email;break;case"password":a=-1!==t.indexOf("login")?f.notEmpty:f.password}(!r||r==i.attr("placeholder")||a&&!a.test(r))&&(n=!1)}),n&&r.removeClass("disabled").attr("disabled",!1)},Tt=function(t){if(t=t||!1,!T)if(!O&&G)_t("login");else if(Et(C),Dt(C,t),C.addClass("selected"),e(".mycars-form").find("input:first").focus(),!o){o=!0;var i=d.LOGIN.IMPRESS,n=i.element,r=i.action,a=i.result,s=i.nonInteractive;K({element:n,action:r,result:a,nonInteractive:s})}},Nt=function(e,i){if(e=e||""){var n=_.omit(t.getUrlParams(e),i);return e.split("?")[0]+t.urlize(n)}return e},kt=function(e,i){var n,r=window.location.pathname+Nt(window.location.search,"referringPage");return n="register"==e?W:T?H:G,i&&(r=t.addUrlParam(r,"_mycarsTrigger",i)),t.createSecureDdcDomainRedirect(n,"referringPage="+encodeURIComponent(r))},_t=function(e){window.open(kt(e),"_self")},St=function(){if(!T&&(Et(C),Dt(C),C.addClass("selected"),e(".mycars-form").find("input:first").focus(),!c)){c=!0;var t=d.FORGOT.IMPRESS,i=t.element,n=t.action,r=t.result,a=t.nonInteractive;K({element:i,action:n,result:r,nonInteractive:a})}},Ot=function(i){var n=i.find(".popup"),r=n.find(".mycars-list"),a=n.find(".mycars-tel"),s=i.data("key"),o=h[s];if(T)i==D&&(r=e("#savedTab .mycars-mobile-list"),a=e("#savedTab .mycars-tel"),e("#savedTab .empty-content")[o.length>0?"addClass":"removeClass"]("hide")),i==P&&(r=e("#alertsTab .mycars-mobile-list"),a=e("#alertsTab .mycars-tel"),e("#alertsTab .empty-content")[o.length>0?"addClass":"removeClass"]("hide"));else if("priceAlerts"==s&&!O&&W)return _t("register"),!1;Et(i),y.navbar?n.css("right","0")[o.length>0?"removeClass":"addClass"]("empty-list"):n.css("left",Math.min(e(window).width()-(i.offset().left+n.width()+10),0)+"px")[o.length>0?"removeClass":"addClass"]("empty-list"),r.find("> li").remove(),r.append(_.reduce(o,function(e,i){null!=t.Widgets.fieldFormatterFlags&&null!=t.Widgets.fieldFormatterFlags.mycars&&(i.attributes.title=i.attributes.make==t.Widgets.fieldFormatterFlags.mycarsCompliantTitleFranchise?t.Widgets.fieldFormatter.title(i.attributes,t.Widgets.fieldFormatterFlags.mycarsCompliantTitlePattern):t.Widgets.fieldFormatter.title(i.attributes,t.Widgets.fieldFormatterFlags.mycars));var n=i.attributes,r={vdpHref:"/404.html"!=n.detailsURL?n.detailsURL+"?mycarsr=vdp-"+s:"#",price:"0"!=n.displayPrice?t.format.currency(Math.floor(n.displayPrice),0):"0"!=n.internetPrice?t.format.currency(Math.floor(n.internetPrice),0):"",time:new Date(i.statuses[p[s].statusType].statusDate).toJSON(),miles:(n.odometer||"").toString().replace(f.currency,",")};if("priceAlerts"==s&&i.latestNotifications.PRICE_CHANGE){var a=i.latestNotifications.PRICE_CHANGE,o=a.oldPrice-a.newPrice;_.extend(r,{saved:t.format.currency(Math.floor(Math.abs(o)),0),priceDiff:o,priceChangeId:a.id,time:new Date(a.notifyDate).toJSON()})}if("priceAlerts"==s&&i.latestNotifications.NEW_INCENTIVES){var l=i.latestNotifications.NEW_INCENTIVES;return _.extend(r,{incentiveId:l.id,time:new Date(l.notifyDate).toJSON()}),e+m.incentives({item:i,computed:r})}return l?void 0:e+m[s]({item:i,computed:r})},"")),r.find("> li").first().addClass("mycars-first-row"),r.find(".timeago").timeago(),r.find(".mycars-btn, .mycars-btn-no-toggle").each(function(){var t=e(this).closest(".mycars-vehicle").data("id");if(e(this).attr("data-id",t),e(this).attr("href").match(/vehicleId=/)){var i=e(this).attr("href").split("&");i[1]="vehicleId="+t,e(this).attr("href",i.join("&"))}}),X(r.find(".mycars-btn")),Dt(i),i.addClass("selected"),"priceAlerts"==s&&e(document).trigger("modulesRefresh"),T&&(r.children().length&&a.length?a.removeClass("hide"):r.children().length||a.hasClass("hide")||a.addClass("hide"))},At=function(e,t){var i=e.val().replace(/^\s+|\s+$/g,"");return!i||i==e.attr("placeholder")||t&&!t.test(i)?(e.addClass("input-error"),null):(e.removeClass("input-error"),i)},Rt=function(e){var t=e.querySelector('[type="submit"]');if(t){if(t.classList.contains("mycars-form-btn"))return t.value;if(t.classList.contains("ui-button-submit"))return t.textContent}},Lt=function(i,n){i.preventDefault();var r=T&&!G?e("#ddc-slidein-panel-mycars-slidein-panel").find(".mycars-form.login-form"):e(this);n&&"eprice"===n&&(r=e(".eprice-form .login-form"));var a=At(r.find('input[name="contact.email"]'),f.email),s=null,o=r.find('input[name="contact.password"]'),l=o.val();o.length>0&&(s=l);var c=i.currentTarget,u=Rt(c)||"Log In";if(null!==a){var m={email:a};s&&(m={email:a,password:s}),r.find(".error-text").html(""),r.find(".input-error").removeClass("input-error");var p=d.LOGIN.SUBMIT,v=p.element,g=p.action,y=p.result,b=p.nonInteractive;K({element:v,action:g,result:y,nonInteractive:b,elementCTA:u,optionalData:{element:c}}),Ct("login",m,function(t){h.profile=t,st(function(){var e=d.LOGIN.CONFIRM_IMPRESS,t=e.element,i=e.action,a=e.result,s=e.nonInteractive;K({element:t,action:i,result:a,nonInteractive:s,optionalData:{element:c}}),$("login",void 0,void 0,void 0,{element:r[0]}),dt(),R&&ct(),et(),(G||B)&&Ut(),n&&"eprice"===n&&Qt()}),T&&e(".ddc-mobile-slidein-content").find(".active-overlay").removeClass("active-overlay")},{"*":function(){var e=d.LOGIN.FAIL,i=e.element,n=e.action,s=e.result,l=e.nonInteractive;K({element:i,action:n,result:s,nonInteractive:l,elementCTA:u,optionalData:{element:c}}),$("login-unsuccessful","not-registered",void 0,void 0,{element:r[0]}),r.find(".error-text").html(o.length>0?t.i18n.getLabel("THE_EMAIL_OR_PASSWORD_YOU_ENTERED_IS_INCORRECT"):a+" "+t.i18n.getLabel("IS_NOT_REGISTERED"))}})}else{$("login-unsuccessful","validation error",void 0,void 0,{element:r[0]});var I=d.LOGIN.FAIL,w=I.element,C=I.action,E=I.result,D=I.nonInteractive;K({element:w,action:C,result:E,nonInteractive:D,elementCTA:d.LOGIN.FAIL.element,optionalData:{element:c}}),r.find(".error-text").html(t.i18n.getLabel("PLEASE_FIX_HIGHLIGHTED_FIELDS"))}},Ut=function(){var e=t.getUrlParams().referringPage;window.open(e||"/","_self")},xt=function(i,n){i.preventDefault();var r=n,a=At(r.find('input[name="contact.email"]'),f.email),s=e(".page-bd").find(".reset-message .content, #password-reset-request"),o=r.parent().find(".register-sales, .forgot-password-form"),l="password-reset-request"==n.attr("id")?s:o,c=l.length,u=function(){l.fadeOut(function(){--c>0&&e(t.i18n.getMessage("PASSWORD_RESET_REQUEST_VERBIAGE")).hide().insertBefore(r).fadeIn()})},m=n[0],p=Rt(m)||"Request Password Reset";if(null!==a){var v=d.FORGOT.SUBMIT,g=v.element,y=v.action,b=v.result,I=v.nonInteractive;K({element:g,action:y,result:b,nonInteractive:I,elementCTA:p,optionalData:{element:m}}),Ct("request-password-reset",{email:a},function(e){var t=d.FORGOT.CONFIRM_IMPRESS,i=t.element,n=t.action,r=t.result,a=t.nonInteractive;K({element:i,action:n,result:r,nonInteractive:a,optionalData:{element:m}}),u(),h.profile=e})}else{var w=d.FORGOT.FAIL,C=w.element,E=w.action,D=w.result,P=w.nonInteractive;K({element:C,action:E,result:D,nonInteractive:P,elementCTA:p,optionalData:{element:m}}),$("password-reset-unsuccessful","validation error",void 0,void 0,{element:r[0]})}},Mt=function(t,i,n,r){var a,s=e(t).find(i).first(),o=e(t).find(i).first().data("container"),l=s.parents(".inventory-lead-instant-eprice").length>0;a=s.parents(".mycars-mobile").length>0?e(".mycars-mobile .section-register"):l?s.closest("form").parent().parent():e(s.parents(".popup").length>0?o:".page-bd");var c=a.find(i).first().val(),d=a.find(t+" "+n),u=e('input[name="contact.passwordConfirm"]:focus'),m=d.val(),p=e(t).find(r),v=/[A-Z]/,g=/[a-z]/,h=/[0-9]/,y=c?At(s,f.password):void 0,b=function(){if(c===m&&""!==c&&y){if(c==m&&y)return Pt("register"),d.removeClass("input-error"),!0}else if(p.addClass("disabled").attr("disabled",!0),u.length&&""!==m&&d.addClass("input-error"),""!==m&&y)return d.addClass("input-error"),!1},I=e(".character-requirements"),w=e(".uppercase-requirements"),C=e(".lowercase-requirements"),E=e(".numerical-requirements"),D=e(".match-requirements"),P="complete text-success";I.removeClass(P),w.removeClass(P),C.removeClass(P),E.removeClass(P),D.removeClass(P),c&&c.length>=6&&I.addClass(P),v.test(c)&&w.addClass(P),g.test(c)&&C.addClass(P),h.test(c)&&E.addClass(P),b()&&D.addClass(P)},Vt=function(){var t=e(".page-bd"),i=".login-password-reset form",n=e(i),r=n.find(".ui-button-submit"),a='input[name="contact.password"]',s='input[name="contact.passwordConfirm"]',o=t.find(".confirm-message"),l=t.find(".invalid-message"),c=t.find(".generic-message"),d=n.closest(".container > .page-bd .ddc-span5, .ddc-page > .page-bd .region.main .yui3-u-3-5, .page-bd > .mobile"),u=function(e){for(var t=window.location.search.substring(1),i=t.split("&"),n=0;n<i.length;n++){var r=i[n].split("=");if(r[0]==e)return r[1]}},m=u("p"),p=u("t"),v=u("e");e(window.document).on(F,a,function(){Mt(i,a,s,r),Pt("#password-reset")}),e(window.document).on(F,s,function(){Mt(i,a,s,r),Pt("#password-reset")}),r.on("click",function(t){t.preventDefault();var i=At(n.find(a),f.password);null!==i?Ct("password-reset",{email:v,password:i,profileId:m,passwordResetRequestToken:p},function(t){h.profile=t,$("reset-successful","password reset"),T&&e(".ddc-mobile-slidein-content").find(".active-overlay").removeClass("active-overlay"),d.fadeOut("slow",function(){d.empty().append(o.removeClass("hide")).fadeIn("slow")}),Ct("login",{email:v,password:i},function(t){h.profile=t,st(function(){$("login"),dt(),R&&ct(),et()}),T&&e(".ddc-mobile-slidein-content").find(".active-overlay").removeClass("active-overlay")})},{403:function(){$("reset-unsuccessful","invalid token",void 0,void 0,{element:n[0]}),d.fadeOut("slow",function(){d.empty().append(l.removeClass("hide")).fadeIn("slow")}),Ct("request-password-reset",{email:v},function(e){h.profile=e})},"*":function(){d.fadeOut("slow",function(){d.empty().append(c.removeClass("hide")).fadeIn("slow")})}}):($("reset-unsuccessful","validation error",void 0,void 0,{element:n[0]}),n.find(".mismatch").remove(),n.submit())})},Ft=function(i,n){i.preventDefault();var r=T&&!W?e("#ddc-slidein-panel-mycars-slidein-panel").find(".mycars-form.register-form"):e(this);n&&"eprice"===n&&(r=e(".eprice-form .register-form"));var a=r.find('input[name="contact.firstName"]'),s=r.find('input[name="contact.lastName"]'),o=r.find('input[name="contact.password"]'),l="",c="",u=null,m=At(r.find('input[name="contact.email"]'),f.email),p=[l,c,m];a.length>0&&(l=At(a),c=At(s)),o.length>0&&(u=At(r.find('input[name="contact.password"]'),f.password),p=[l,c,m,u]);var v=i.currentTarget,g=Rt(v)||"Sign Up Now!";if(_.every(p,function(e){return null!==e})){r.find(".error-text").html(""),r.find(".input-error").removeClass("input-error");var y=d.REGISTER.SUBMIT,b=y.element,I=y.action,w=y.result,C=y.nonInteractive;K({element:b,action:I,result:w,nonInteractive:C,elementCTA:g,optionalData:{element:v}}),Ct("create",{email:m,password:u,firstName:l,lastName:c,source:"DDC"},function(t){r.closest(".popup").addClass("show-confirm").find(".email-text").html(t.email),T&&e(".email-text").html(t.email),D.removeClass("recently-saved"),h.profile=t,st(function(){var e=d.REGISTER.CONFIRM_IMPRESS,t=e.element,i=e.action,a=e.result,s=e.nonInteractive;K({element:t,action:i,result:a,nonInteractive:s,optionalData:{element:v}}),$("register","submit",void 0,void 0,{element:r[0]}),dt(),R&&ct(),et(),Q(),W&&Ut(),n&&"eprice"===n&&Qt()})},{409:function(){var e=d.REGISTER.EXISTING,i=e.element,n=e.action,a=e.result,s=e.nonInteractive;K({element:i,action:n,result:a,nonInteractive:s,elementCTA:g,optionalData:{element:v}}),$("registration-unsuccessful","already registered",void 0,void 0,{element:r[0]}),r.find(".error-text").html(m+" "+t.i18n.getLabel("IS_ALREADY_REGISTERED"))}})}else{var E=d.REGISTER.FAIL,P=E.element,N=E.action,k=E.result,S=E.nonInteractive;K({element:P,action:N,result:k,nonInteractive:S,elementCTA:g,optionalData:{element:v}}),$("registration-unsuccessful","validation error",void 0,void 0,{element:r[0]}),r.find(".error-text").html(t.i18n.getLabel("PLEASE_FIX_HIGHLIGHTED_FIELDS"))}},Gt=function(e,t){Ct("upsert",{statuses:{RECENTLY_VIEWED:{statusType:"RECENTLY_VIEWED"}}},t,null,h.profile.profileId+"/vehicles/"+e)},Wt=function(e,t,i){Ct("upsert",{statuses:_.extend({SAVED:{statusType:"SAVED"}},t?{NOTIFICATIONS_ENABLED:{statusType:"NOTIFICATIONS_ENABLED"}}:{})},i,null,h.profile.profileId+"/vehicles/"+e)},Ht=function(){return t.userProfileController.hasUserContactData()&&t.WidgetData&&t.WidgetData.inventoryLeadInstantEprice&&t.WidgetData.inventoryLeadInstantEprice.showAfterLeadSubmit&&t.userProfile.ePriceVehicles},Bt=function(i){var n=new Date;n.setDate(n.getDate()+1);var r="",a="";if(a=t.userProfile?t.userProfile:JSON.parse(sessionStorage.getItem("drUserSession"))){var s=a.ePriceVehicles;if(s)for(var o in s)r=s[o].itemUUID+","+r}i&&-1===r.indexOf(i)&&(r+=i),r.length>0&&e.cookie("DDC.ePriceVehicles",r,{expires:n,path:"/"}),Ht()&&e.cookie("DDC.ePriceVisible","1",{expires:n,path:"/"})},jt=function(){e.removeCookie("DDC.ePriceVehicles",{path:"/"}),e.removeCookie("DDC.ePriceVisible",{path:"/"})},qt=function(e){h.profile.profileId?Yt(e,function(){R&&ct()}):Ct("create",{source:"ANONYMOUS"},function(t){h.profile=t,Yt(e,function(){R&&ct()})}),Bt(e)},Yt=function(e,t){Ct("upsert",{statuses:{EPRICE:{statusType:"EPRICE"}}},t,null,h.profile.profileId+"/vehicles/"+e)},Qt=function(){var i=null,n=null,r=e(".instantEPriceButton"),a=r.find('[data-name="instant-price-dialog"]'),s=a.data("href");L?(n=L,i=t.userProfileController.sendLeadForm(s)):(i=t.currentVLPDialog.instantEpriceUrl,n=t.currentVLPDialog.instantEpriceVehicleId),t.userProfileController.saveInstantEpriceVehicle(null,n),t.toolbar.saveEpriceVehicleStatus(n),t.userProfileController.sendLeadForm(i),s&&s.indexOf("vcdaInstantEPrice")>-1||!a.data("item-value")?window.DDC&&window.DDC.pubsub&&window.DDC.pubsub.publish&&window.DDC.pubsub.publish("instant-eprice.complete",n):e.publish("showInstantEprice.dialog")},zt=function(e,t,i){var n=_.findWhere(e,{itemUUID:t});n&&(n.statuses=_.omit(n.statuses,i))},Jt=function(e){if(!_.findWhere(h.savedCars,{itemUUID:e})){h.profile.email||D.addClass("recently-saved");var t=function(){},i=function(){var t=_.findWhere(h.savedCars,{itemUUID:e});z(t),Xt(t.itemUUID,t.attributes.numSaves),nt([E,D]),$("save-vehicle")};t=_.partial(at,D,i),h.profile.profileId?Wt(e,!!h.profile.email,function(){t(),R&&ct()}):Ct("create",{source:"ANONYMOUS"},function(i){h.profile=i,Wt(e,!!h.profile.email,function(){t(),R&&ct()})})}},$t=function(t){h.savedCars=_.reject(h.savedCars,function(e){return e.itemUUID==t}),h.priceAlerts=_.reject(h.priceAlerts,function(e){return e.itemUUID==t}),zt(h.recentCars,t,["SAVED","NOTIFICATIONS_ENABLED"]),D.removeClass("recently-saved"),nt([E,D,P]),Ct("delete",null,null,null,h.profile.profileId+"/vehicles/"+t+"/statuses/SAVED"),e('[data-uuid="'+t+'"] .mycars-watchers').slideUp("slow",function(){e(this).remove()})},Kt=function(i){if(h.profile.email){var n=_.findWhere(h.savedCars,{itemUUID:i});if(n){n.statuses=_.extend(n.statuses,{NOTIFICATIONS_ENABLED:{statusType:"NOTIFICATIONS_ENABLED",statusDate:(new Date).getTime()}});var r=n.latestNotifications&&n.latestNotifications.PRICE_CHANGE;r&&"UNREAD"==r.status&&(h.priceAlerts.unshift(n),Ct(null,{notificationType:"PRICE_CHANGE",status:"UNREAD"},null,null,h.profile.profileId+"/vehicles/"+i+"/notifications/"+r.id)),nt([E,D,P]),Wt(i,!0),z(n,!0)}else Jt(i);return $("enable-notifications","enabledNoficationsCount: "+_.filter(h.savedCars,function(e){return _.has(e.statuses,"NOTIFICATIONS_ENABLED")}).length),!0}return Jt(i),T?(t.mobile.slidein.activatePanel("mycars-slidein-panel","right"),e('#mycarsSubnav a[href="#savedTab"]').tab("show"),ii("#registerPanel")):Ot(P),!1},Zt=function(e){h.priceAlerts=_.reject(h.priceAlerts,function(t){return t.itemUUID==e}),zt(h.recentCars,e,["NOTIFICATIONS_ENABLED"]),zt(h.savedCars,e,["NOTIFICATIONS_ENABLED"]),nt([E,D,P]),Ct("delete",null,null,null,h.profile.profileId+"/vehicles/"+e+"/statuses/NOTIFICATIONS_ENABLED");var t=_.findWhere(h.savedCars,{itemUUID:e});return z(t,!1),!0},Xt=function(i,n){var r;e('[data-uuid="'+i+'"] .mycars-watchers').length||n&&t.siteProperties.myCarsRemoveWatchersBanner!==!0&&(T?(r=t.i18n.getLabel("1"==n?"OTHER_HAVE_SAVED_THIS_VEHICLE":"OTHERS_HAVE_SAVED_THIS_VEHICLE"),e("<div class='mycars-watchers'><i class='ddc-icon ddc-icon-mycars-alerts'></i>"+n+" "+r+"</div>").hide().prependTo('[data-uuid="'+i+'"]').fadeIn(1e3)):(r=t.i18n.getLabel("1"==n?"OTHER_HAVE_SAVED_THIS_VEHICLE":"OTHERS_HAVE_SAVED_THIS_VEHICLE"),e("<div class='mycars-watchers'>"+t.i18n.getLabel("YOU_AND")+" "+n+" "+r+"</div>").hide().prependTo('[data-uuid="'+i+'"]').show("slide",{direction:"right"},1e3)))},ei=function(t,i,n){if(n.preventDefault(),!T)if(t.hasClass("selected"))t.removeClass("selected").find(".popup").css("visibility","hidden");else{Et(t),Dt(t);var r=t.find(".popup"),a=r.find(".ct"),s=t.attr("class").match(f.size),o=parseInt(s[1]),l=s[2];a.width(o).height(l),r.css("left",Math.min(e(window).width()-(parseInt(t.offset().left)+o+10),0)+"px").css("visibility","visible"),(i||function(){})(a),t.addClass("selected")}},ti=function(e){if(!e.getAttribute("init")){e.setAttribute("init",!0);var t,i,n,r;if(e.classList.contains("register-form")){var a=d.REGISTER.INTERACT;t=a.element,i=a.action,n=a.result,r=a.nonInteractive}else if(e.classList.contains("login-form")){var s=d.LOGIN.INTERACT;t=s.element,i=s.action,n=s.result,r=s.nonInteractive}else if(e.classList.contains("forgot-password-form")){var o=d.FORGOT.INTERACT;t=o.element,i=o.action,n=o.result,r=o.nonInteractive}K({element:t,action:i,result:n,nonInteractive:r,optionalData:{element:e}})}},ii=function(t){var i=e(".active-overlay");i.length>0&&i.removeClass("active-overlay"),e(t).addClass("active-overlay");var n,r,a,s;if(T&&e(t).on("click input",".register-form,.login-form,.forgot-password-form",function(){ti(this)}),"#loginPanel"===t){if(!o){o=!0;var f=d.LOGIN.IMPRESS;n=f.element,r=f.action,a=f.result,s=f.nonInteractive}}else if("#registerPanel"===t){if(!l){l=!0;var u=d.REGISTER.IMPRESS;n=u.element,r=u.action,a=u.result,s=u.nonInteractive}}else if("#forgotPasswordPanel"===t&&!c){c=!0;var m=d.FORGOT.IMPRESS;n=m.element,r=m.action,a=m.result,s=m.nonInteractive}n&&r&&a&&s&&K({element:n,action:r,result:a,nonInteractive:s,optionalData:{element:this}})},ni=function(t,n,r){var a=e(".notify"),n=e(n).children().clone(),s=e(".navbar .ddc-icon-mycars-viewed"),o=r||3500;clearTimeout(i),e(".ddc-document").hasClass("slidein-open-from-right")&&(a=a.filter(".slidein-notify")),t.indexOf("add")>=0?(a.removeClass("mycars-remove-notify").addClass("mycars-notify open"),a.find(".notify-content").html(n),e(n).removeClass("hide"),s.addClass("add-color"),i=setTimeout(function(){ri()},o)):(a.removeClass("mycars-notify").addClass("mycars-remove-notify open"),a.find(".notify-content").html(e(n)),e(n).removeClass("hide"),s.addClass("remove-color"),i=setTimeout(function(){ri()
},o))},ri=function(){var t=e(".notify"),i=e(".navbar .ddc-icon-mycars-viewed");t.removeClass("mycars-remove-notify mycars-notify open"),i.removeClass("add-color remove-color"),t.off("click.dr-toolbox")},ai=function(){t.getUrlParams().mycarsr&&$("engagement","link-"+t.getUrlParams().mycarsr,"flyout-link")},si=function(i){var n=!1,r=0;if(i)n=li(i);else{k.each(function(){var t=e(this).data("digital-retail-summary-label");S[t]=t});for(var i in S)S[i]&&li(S[i])&&"vehicleOfInterest"!=S[i]&&r++;n=r>0||n;var a=e(".digital-retailing-toolbox"),s=a.find(".toolbox-content"),o=a.find('[data-show-on-state*="all-complete"]'),l=a.find('[data-show-on-state*="all-progress"]'),c=a.find('[data-show-on-state*="all-start"]'),d=a.find('[data-show-on-state*="logged-in"]'),f=a.find('[data-show-on-state*="logged-out"]'),u=s.find(".digital-retailing-summary-section dt:not(.hide)").length;n&&t.userProfile.vehicleOfInterest&&t.userProfile.vehicleOfInterest.itemUUID?(s.show(),T&&(O?(f.hide(),d.show()):(d.hide(),f.show()),c.hide()),u===r?(l.hide(),o.show()):(o.hide(),l.show())):(s.hide(),T&&(l.hide(),c.show(),O?(f.hide(),d.show()):(d.hide(),f.show())))}T&&e("#ddc-slidein-panel").on("click",'[data-toggle="popover"]',function(){var i=e(this),n=e(".ddc-slidein-panel"),r=n.find("#digital-retailing-disclaimer-panel"),a=r.find("#digital-retailing-disclaimer-content");i.closest("#toolboxTab").length>0&&(t.mobile.slidein.activatePanel("mycars-slidein-panel","right"),a.empty().append(i.data("content")),r.addClass("active-overlay"),r.on("click",".close-panel",function(e){e.preventDefault(),r.removeClass("active-overlay")}))}),T&&n&&!O&&ft()},oi=function(e){var i=e.filter("[data-digital-retail-summary-template]");return e.filter("[data-digital-retail-summary-template-alt]").length>0&&t.userProfile.creditApplication&&t.userProfile.creditApplication.referenceNumber&&t.userProfile.preQualification&&!t.userProfile.preQualification.referenceNumber&&(i=e.filter("[data-digital-retail-summary-template-alt]")),i},li=function(i){var n,r,a,s,o={interpolate:/\{\{([\s\S]+?)\}\}/g,evaluate:/\{\{(.+?)\}\}/g},l=e(T?".digital-retailing-summary":".mycars-integration-navbar .toolbox-content"),c=l.find(".digital-retailing-vehicle-of-interest"),d=e("#vehicleOfInterestTemplate"),f=null!=t.userProfile.vehicleOfInterest?t.userProfile.vehicleOfInterest.itemUUID:null,u={},m=null,p=!1,v="drUserSession",g=function(){if(t.userProfile.vehicleOfInterest.attributes.internetPrice=t.format.currencyExtended(t.userProfile.vehicleOfInterest.attributes.internetPrice,{showCurrency:!0}),c.html(_.template(d.html(),t.userProfile.vehicleOfInterest)),!T){l.find(".mycars-resume").empty().append(l.find("[data-mycars-dr-resume-link]"));var i=l.find("[data-mycars-dr-resume-link-inline]");i.length&&i.on("click",function(){e.publish("dr-toolbox-open-next-tool"),Et()})}l.find("[data-digital-retail-link]").each(function(){var i=e(this),n=i.attr("href"),r=n.split("?"),a=t.userProfile.vehicleOfInterest.itemUUID;n.indexOf(a)<0&&(r[1]?r[1]+="&itemId="+a:r[1]="itemId="+a,i.attr("href",r.join("?"))),"payment"==i.attr("data-digital-retail-link")&&i.attr("href").indexOf("404.htm")>-1&&i.attr("href",t.userProfile.vehicleOfInterest.attributes.detailsURL+"?toolbox=payment"),"lifestyle"==i.attr("data-digital-retail-link")&&i.attr("href").indexOf("404.htm")>-1&&i.attr("href",t.userProfile.vehicleOfInterest.attributes.detailsURL+"?toolbox=lifestyle"),"testdrive"==i.attr("data-digital-retail-link")&&i.attr("href").indexOf("404.htm")>-1&&i.attr("href",t.userProfile.vehicleOfInterest.attributes.detailsURL+"?toolbox=testdrive")})};if(i){if(n=l.find('[data-digital-retail-summary="'+i+'"]'),"vehicleOfInterest"!=i&&0===n.length)return null;s=n.filter('[data-show-on-state="complete"]');var h=n.filter('[checkmark-show-on-state="complete"]');switch(a=n.filter('[data-show-on-state="start"]'),r=oi(n),i){case"vehicleOfInterest":t.userProfile.vehicleOfInterest&&t.userProfile.vehicleOfInterest.itemUUID&&(!t.userProfile.vehicleOfInterest.attributes||!t.userProfile.vehicleOfInterest.attributes.detailsURL||t.userProfile.vehicleOfInterest.attributes.detailsURL.indexOf(t.userProfile.vehicleOfInterest.itemUUID)<0?e.ajax({type:"GET",url:"/detailmin.htm?itemId="+t.userProfile.vehicleOfInterest.itemUUID,dataType:"html",success:function(i){var n=e(i);t.userProfile.vehicleOfInterest.attributes={},t.userProfile.vehicleOfInterest.attributes.title=n.find("a.url").html(),t.userProfile.vehicleOfInterest.attributes.imageUri=n.find("img").attr("src"),t.userProfile.vehicleOfInterest.attributes.detailsURL=n.find("a.url").attr("href"),t.userProfile.vehicleOfInterest.attributes.internetPrice=n.find(".pricing li").html(),sessionStorage.setItem(v,JSON.stringify(t.userProfile)),g()}}):g());break;case"trade":var y;if(t.userProfile.ownedVehicle&&t.userProfile.ownedVehicle.valuations&&t.userProfile.ownedVehicle.valuations.length>0){var b,I=!1,w=t.userProfile.ownedVehicle.valuations[t.userProfile.ownedVehicle.valuations.length-1];y="MoreInfo"==w.thirdPartyAttributes.SACStatus?t.i18n.getLabel("MORE_INFO_NEEDED"):t.format.currencyExtended(w.offer,{showCurrency:!0})||r.attr("data-label-no-value"),w.thirdPartyAttributes.hasOwnProperty("SACStatus")?(b=[t.userProfile.ownedVehicle.year,t.userProfile.ownedVehicle.make,t.userProfile.ownedVehicle.model].join(" "),"MoreInfo"!=w.thirdPartyAttributes.SACStatus&&(I=!0)):b=[t.userProfile.ownedVehicle.year,t.userProfile.ownedVehicle.make,w.thirdPartyAttributes.model,w.thirdPartyAttributes.serie,w.thirdPartyAttributes.style].join(" "),u={vehicleName:b,offer:y,account:{name:t.dataLayer.dealership.dealershipName}};var C=e(".digital-retailing-toolbox .digital-retailing-summary-section").find(".help-text.ddc-icon");if("MoreInfo"==w.thirdPartyAttributes.SACStatus?C.css("display","none"):C.css("display","block"),I){var E=t.i18n.getLabel("APPRAISED_TRADE_IN_VALUE"),D=_.template(t.i18n.getLabel("TRADE_VALUE_DISCLAIMER"),{template:u},o),P="hover",N="left";T?(P="click",N="bottom",e("#tradeSummaryCompleteDisclaimer").append("<h4>"+E+"</h4>"+D)):setTimeout(function(){e(".digital-retailing-toolbox .digital-retailing-summary-section").find(".help-text.ddc-icon").popover({trigger:P,container:".digital-retailing-summary",placement:N,title:E,content:D,html:!0})},200)}}else t.userProfile.progress&&t.userProfile.progress.SONIC_RTC_TRADE&&(1==t.userProfile.progress.SONIC_RTC_TRADE.state.formdata["trade.optedOut"]||"true"==t.userProfile.progress.SONIC_RTC_TRADE.state.formdata["trade.optedOut"])&&(y=t.i18n.getLabel("OPT_OUT_NO_TRADE_IN"),u={offer:y},setTimeout(function(){e(".digital-retailing-toolbox .digital-retailing-summary-section").find(".help-text.ddc-icon").css("display","none")},200));break;case"accessories":if(t.userProfile.vehicleAccessories&&t.userProfile.vehicleAccessories[f]&&t.userProfile.vehicleAccessories[f].accessories&&t.userProfile.vehicleAccessories[f].accessories.length>0&&t.userProfile.vehicleAccessories[f].accessoriesTotal>0){if(1==t.userProfile.vehicleAccessories[f].accessories.length)var k=t.i18n.getLabel("ACCESSORY_ADDED");else var k=t.i18n.getLabel("ACCESSORIES_ADDED");u={accessoriesTotal:t.format.currencyExtended(t.userProfile.vehicleAccessories[f].accessoriesTotal,{showCurrency:!0}),accessoriesCount:t.userProfile.vehicleAccessories[f].accessories.length+" "+k}}break;case"payment":if(t.userProfile.paymentQuotes&&t.userProfile.paymentQuotes[f]){var S,O=t.userProfile.paymentQuotes[f],A=l.find('[data-digital-retail-summary-label="payment"]').filter("[data-digital-retail-summary-label-template]"),R=l.find('[data-digital-retail-summary-label="payment"] .summary-label'),L=A.text().split("|",2);if(O.errorType)switch(u={title:null,description:null},m=r.html().split("|",3)[2],O.errorType){case"HIGH_BUY_POWER":u.title=t.i18n.getLabel("NONE"),u.description=t.i18n.getLabel("PLAN_TO_PAY_IN_FULL");break;case"LOW_BUY_POWER":u.title=t.i18n.getLabel("PLEASE_CALL"),u.description=t.i18n.getLabel("MORE_INFO_NEEDED");break;case"GENERAL":u.title=t.i18n.getLabel("PLEASE_CALL"),u.description=t.i18n.getLabel("PAYMENT_INFO_UNAVAILABLE_AT_THIS_TIME")}else 1==t.userProfile.paymentQuotes[f].optedOut?(u={optOut:!0},setTimeout(function(){var i=e('dd[data-digital-retail-summary="payment"][data-show-on-state="complete"] span:eq(0)'),n=e('dd[data-digital-retail-summary="payment"][data-show-on-state="complete"] span:eq(1)');i.text(t.i18n.getLabel("NOT_INTERESTED")),n.remove()},200)):u={monthlyPayment:t.format.currencyExtended(O.monthlyPayment,{showCurrency:!0}),downPayment:t.format.currencyExtended(O.downPayment,{showCurrency:!0}),term:O.term,apr:O.apr+"%",dueAtSigning:t.format.currencyExtended(O.dueAtSigning,{showCurrency:!0})},"loan"===O.type?S=0:(S=1,u.annualMiles=t.format.number(O.annualMiles)),m=r.html().split("|",3)[S],T&&(R.find(".digital-retailing-summary-section-label").eq(0).text(L[S]),O&&e("dd.inline-personalize-payment").css("display","none"))}break;case"prequal":t.userProfile.preQualification&&t.userProfile.preQualification.referenceNumber?u={referenceNumber:t.userProfile.preQualification.referenceNumber}:t.userProfile.creditApplication&&t.userProfile.creditApplication.referenceNumber&&(u={referenceNumber:t.userProfile.creditApplication.referenceNumber});break;case"finance":t.userProfile.creditApplication&&t.userProfile.creditApplication.referenceNumber?u={referenceNumber:t.userProfile.creditApplication.referenceNumber}:t.userProfile.creditApplication&&t.userProfile.creditApplication.optedOut&&(setTimeout(function(){var i=e('dd[data-digital-retail-summary="finance"][data-show-on-state="complete"] span:eq(0)'),n=e('dd[data-digital-retail-summary="finance"][data-show-on-state="complete"] span:eq(1)');i.text(t.i18n.getLabel("NOT_INTERESTED")),n.remove()},200),u={optOut:!0});break;case"reserve":t.userProfile.vehicleReservations&&t.userProfile.vehicleReservations[f]&&(u={referenceNumber:t.userProfile.vehicleReservations.id});break;case"protect":t.userProfile.protectionPlan&&(u={complete:!0,protectionStatus:"selected"===t.userProfile.protectionPlan.toLowerCase()?"Selected":"Deferred"});break;case"lifestyle":if(t.userProfile.progress&&t.userProfile.progress.INLINE_DR_MENU){var U=1==t.userProfile.progress.INLINE_DR_MENU.state.isCompleted||1==t.userProfile.progress.INLINE_DR_MENU.state.isOptedOut;u={complete:!0,lifestyleStatus:t.i18n.getLabel(1==t.userProfile.progress.INLINE_DR_MENU.state.isCompleted?"SUBMITTED":"NOT_INTERESTED")},T&&U&&e("dd.inline-lifestyle-menu").css("display","none")}break;case"testdrive":var x=t.userProfile.progress&&t.userProfile.progress.INLINE_DR_TESTDRIVE;if(x){var M=1==t.userProfile.progress.INLINE_DR_TESTDRIVE.state.completed||1==t.userProfile.progress.INLINE_DR_TESTDRIVE.state.optedOut,V=1==t.userProfile.progress.INLINE_DR_TESTDRIVE.state.completed,F=1==t.userProfile.progress.INLINE_DR_TESTDRIVE.state.optedOut;if(V||F){var G="";if(V){var W=t.userProfile.progress.INLINE_DR_TESTDRIVE.state.time,H=new Date(W),B={weekday:"long",month:"long",day:"numeric",hour:"numeric",minute:"numeric"},j=(H.getFullYear(),H.toLocaleDateString("en-US",B).split(",")),q=t.userProfile.progress.INLINE_DR_TESTDRIVE.state.selectedLocationFormattedDDCId||"";G="<span>"+q+" </span><span>"+j[0]+", "+j[1]+" at "+j[2]+"</span>"}F&&(G="<span>"+t.i18n.getLabel("NOT_INTERESTED")+"</span>"),u={complete:!0,testdriveStatus:G}}T&&M&&e("dd.inline-testdrive-menu").css("display","none")}break;default:u={}}_.isEmpty(u)?(s.hide(),h.hide(),a.show()):(m=m||r.html(),s.html(_.template(m,{template:u},o)).show(),h.show(),a.hide(),p=!0)}return p},ci=function(e,t){return-1!==e.indexOf(t,e.length-t.length)},di=function(){var t=location.pathname;(ci(G,t)||ci(W,t))&&(O?(e(".ua-not-logged-in").toggleClass("hide",!0),e(".ua-logged-in").toggleClass("hide",!1)):(e(".ua-not-logged-in").toggleClass("hide",!1),e(".ua-logged-in").toggleClass("hide",!0)))},fi=function(i,n){var r=".mycars-save-btn",a=".mycars-add-alert-btn",s=n.find(r),o=n.find(a),l=s?s.attr("class").replace(/\s/g,"."):r,c=o?s.attr("class").replace(/\s/g,"."):a,d=kt("login",l),f=kt("login",c),u=kt("register",l),m=kt("register",c);t.mobile.slidein.activatePanel("mycars-slidein-panel","right"),"add-alert"==i?e('#mycarsSubnav a[href="#alertsTab"]').tab("show"):e('#mycarsSubnav a[href="#savedTab"]').tab("show"),e("#savedTab .empty-content").toggleClass("hide",!0),e("#savedTab .login-to-proceed").toggleClass("hide",!1),e("#alertsTab .empty-content").toggleClass("hide",!0),e("#alertsTab .login-to-proceed").toggleClass("hide",!1),e("#savedTab").find('a[href="#loginPanel"]').hide().end().find('a[href="#registerPanel"]').hide().end().find(".login-intercept-button-login").attr("href",d).toggleClass("hide",!1).end().find(".login-intercept-button-register").attr("href",u).toggleClass("hide",!1),e("#alertsTab").find('a[href="#loginPanel"]').hide().end().find('a[href="#registerPanel"]').hide().end().find(".login-intercept-button-login").attr("href",f).toggleClass("hide",!1).end().find(".login-intercept-button-register").attr("href",m).toggleClass("hide",!1),e("#ddc-slidein-panel-gutter").addClass("mycars-login-intercept-active"),ui()},t=t||{};t.Widgets=t.Widgets||{},t.Widgets.MyCars=t.Widgets.MyCars||{},t.toolbar={addNotifications:Kt,removeNotifications:Zt,removeVehicle:$t,saveEpriceVehicleStatus:qt},t.Widgets.MyCars.isUserLoggedIn=function(){return O},t.Widgets.MyCars.isMobile=T,t.Widgets.MyCars.promptUserLogin=T?ii:Tt;var ui=function(){var t=e(T?".digital-retailing-summary":".mycars-integration-navbar .toolbox-content"),i=t.find("[data-digital-retail-link-inline-payment]"),n=t.find("[data-digital-retail-link-inline-lifestyle]"),r=t.find("[data-digital-retail-link-inline-testdrive]"),a=!1;e("html").hasClass("vdp")&&(a=!0),i.length&&i.on("click",function(t){a&&(t.preventDefault(),e(".ddc-slidein-panel-gutter").click(),e.publish("dr-toolbox-open-calc"))}),n.length&&n.on("click",function(t){a&&(t.preventDefault(),e(".ddc-slidein-panel-gutter").click(),e.publish("dr-toolbox-open-lifestyle"))}),r.length&&r.on("click",function(t){a&&(t.preventDefault(),e(".ddc-slidein-panel-gutter").click(),e.publish("dr-toolbox-open-testdrive"))})};e(document).ready(function(){var i=w.find("> .social");if(tt(),window.addEventListener?window.addEventListener("message",mt,!1):window.attachEvent&&window.attachEvent("onmessage",mt),e(window).load(ai),e(window).height()<600&&I.find(".popup .bd").css({"max-height":350}),!T){var n=J();_.each([E,D,P],function(e){Z(e.find(".count"),n[e.data("key")])})}b.removeClass("hide"),I.length>0&&It(),C.add(E).add(D).add(P).find("> a").add(".mycars-login").click(function(t){t.preventDefault();var i=e(this).parent();e(this).is(".mycars-login")&&(t.stopPropagation(),i=C),i.hasClass("selected")?Et():($("engagement","open-"+i.data("key")),i.is(".login")?Tt():Ot(i))}),C.add(".login-default").find(".login-form").submit(Lt),e(".login-default").find(".login-form fieldset").last().append('<div class="error-text"></div>'),e(".login-register").find(".register-form fieldset").last().append('<div class="error-text"></div>'),C.find(".mycars-form.forgot-password-form").on("submit",function(t){xt(t,e(this))}),e("#password-reset-request").on("submit",function(t){xt(t,e(this))}),e(window.document).on(F,"#password-reset-request .email",function(){Pt("#password-reset-request")}),I.add(".login-register").find(".register-form").submit(Ft),setTimeout(function(){(!T&&e(".register-form")[0]||e(".password-reset")[0])&&e(".validate-password").find('input[name="contact.password"], input[name="contact.passwordConfirm"]').popover({trigger:"focus",placement:"right",content:t.i18n.getMessage("PASSWORD_REQUIREMENTS_VERBIAGE"),html:!0})},5),e(".login-password-reset")[0]&&Vt(),e(window.document).on(F,".mycars-form-textfield",function(){var t=e(this).attr("type"),i=e(this).parents(".mycars-form").parents("div").attr("class").replace("-content","");-1!=i.indexOf(" forgot-password")&&(i=i.replace(" forgot-password","")),Pt(i),""!==e(this).val()&&e(this).hasClass("password")&&e(this).closest("form").hasClass("login-form")?At(e(this),f.notEmpty):""===e(this).val()||e(this).hasClass("password-confirm")||At(e(this),f[t])}),e(window.document).on("click",".logout",function(t){t.preventDefault(),I.find("input.mycars-form-textfield").val(""),Ct("logout",null,function(){h.profile.email=null,h.profile.profileId=null,e.publish("mycars-user-logging-out");var t=I.find(".logout").get(0),i=d.LOGOUT.CLICK,n=i.element,r=i.action,a=i.result,s=i.nonInteractive;K({element:n,action:r,result:a,nonInteractive:s,optionalData:{element:t}}),st(et)}),R&&ut(),jt(),G&&Et()}),e(window.document).on("keydown",function(e){e.keyCode&&27===e.keyCode&&Et()}),C.find(" > a").on("click",function(){e(this).parents(".login").hasClass("selected")&&Pt("login")}),I.find(".recent-cars a[href*=#recent-cars], .saved-cars a[href*=#saved-cars], .price-alerts a[href*=#price-alerts], .recent-cars .register-toggle .show-text, .saved-cars .register-toggle .show-text").click(function(){Pt("register")}),C.find(".forgot-password-link, .register-link, .login-link").on("click",function(){V=e(this).closest(".mycars-postform-links").siblings("form").find(".email").val()}),I.find(".login-link").click(function(t){$("login-link",e(this).closest(".menu").data("key"));var i=V;i&&C.find(".login-content .email").val(i),Pt(e(this).attr("href").replace("#","")),t.preventDefault(),t.stopPropagation(),C.removeClass("show-forgot-password"),C.removeClass("show-register"),Tt()}),e(window.document).on(F,"#login input",function(){Pt("#login")}),e(window.document).on(F,"#register input",function(){Pt("#register")}),C.find(".register-link").click(function(t){$("register-link","login");var i=V;if(i&&C.find(".register-content .email").val(i),Pt(e(this).attr("href").replace("#","")),t.preventDefault(),C.removeClass("show-forgot-password"),C.addClass("show-register"),!l){l=!0;var n=d.REGISTER.IMPRESS,r=n.element,a=n.action,s=n.result,o=n.nonInteractive;K({element:r,action:a,result:s,nonInteractive:o})}}),e(".mycars-register").on("click",function(e){if(e.preventDefault(),e.stopPropagation(),$("register-link","info"),C.addClass("show-register"),!l){l=!0;var t=d.REGISTER.IMPRESS,i=t.element,n=t.action,r=t.result,a=t.nonInteractive;K({element:i,action:n,result:r,nonInteractive:a})}Tt()}),e(window.document).on(F,'.register-form input[name="contact.password"]',function(){var t=e(this).closest(".register-form").attr("id"),i=".mycars-form-btn";e(this).closest("div.eprice-form").hasClass("eprice-form")&&(i='button[type="submit"]'),Mt("#"+t,'input[name="contact.password"]','input[name="contact.passwordConfirm"]',i)}),e(window.document).on(F,'.register-form input[name="contact.passwordConfirm"]',function(){var t=e(this).closest(".register-form").attr("id"),i=".mycars-form-btn";e(this).closest("div.eprice-form").hasClass("eprice-form")&&(i='button[type="submit"]'),Mt("#"+t,'input[name="contact.password"]','input[name="contact.passwordConfirm"]',i)}),C.find(".forgot-password-link").click(function(t){t.preventDefault(),$("forgot-password-link","forgot-password");var i=V;i&&C.find(".forgot-password-content .email").val(i),Pt(e(this).attr("href").replace("#","")),C.removeClass("show-register"),C.addClass("show-forgot-password"),St();var n=e(".forgot-password-form"),r=n.find(".error-text");r.html(""),n.parent().find(".register-sales, .form-group, input").show(),n.find(".password-reset-heading, .password-reset-body").remove()}),I.on("click",".mycars-save-btn",function(){return Jt(e(this).data("id")),!1}),e(window.document).on("click",".mycars-save-btn",function(){if(T&&B&&!O)fi("save",e(this).closest(".mycars-buttons"));else if($("engagement",(e(".vlp").length>0?"vlp":"vdp")+"-save-vehicle"),Et(D),Jt(e(this).data("id")),h.profile.email||Ot(D),T){var t=e(this).attr("data-message");ni("add-saved",t)}return!1}),I.on("click",".mycars-saved-btn",function(){return $("remove-vehicle","recentCars"),$t(e(this).data("id")),!1}),e(window.document).on("click",".mycars-saved-btn",function(){if($("engagement",(e(".vlp").length>0?"vlp":"vdp")+"-remove-vehicle"),Et(D),$t(e(this).data("id")),T){var t=e(this).attr("data-message");ni("remove-saved",t)}return!1}),I.on("click",".mycars-add-alert-btn",function(t){Kt(e(this).data("id")),t.preventDefault()}),e(window.document).on("click",".mycars-add-alert-btn",function(){if(T&&B&&!O)fi("add-alert",e(this).closest(".mycars-buttons"));else if($("engagement",(e(".vlp").length>0?"vlp":"vdp")+"-enable-notifications"),Et(P),Kt(e(this).data("id")),T){if(!O&&W)return _t("register"),!1;if(h.profile.email){var i=e(this).attr("data-message");ni("add-alert",i)}else t.mobile.slidein.activatePanel("mycars-slidein-panel","right"),e('#mycarsSubnav a[href="#savedTab"]').tab("show"),ii("#registerPanel")}return!1}),e(window.document).on("click",".mycars-unsub-all-price-alerts",function(){return e(".mycars-mobile-list").find(".mycars-alerts-isset").not(".hide").each(function(t,i){if(Zt(e(i).data("id")),T){var n=e(this).attr("data-message");ni("remove-alert",n)}}),!1}),I.on("click",".mycars-alerts-isset",function(){return $("disable-notifications",e(this).closest(".menu").data("key")),Zt(e(this).data("id")),!1}),e(window.document).on("click",".mycars-alerts-isset",function(){if($("engagement",(e(".vlp").length>0?"vlp":"vdp")+"-disable-notifications"),Et(P),Zt(e(this).data("id")),T){var t=e(this).attr("data-message");ni("remove-alert",t)}return!1}),D.on("click",".remove",function(){return $("remove-vehicle","savedCars"),$t(e(this).closest(".mycars-vehicle").data("id")),!1}),P.on("click",".remove",function(){$("hide-notification","enabledNoficationsCount: "+_.filter(h.savedCars,function(e){return _.has(e.statuses,"NOTIFICATIONS_ENABLED")}).length);var t=e(this).closest(".mycars-vehicle"),i=t.data("id"),n=t.data("notiftype"),r=t.data("notifid");return h.priceAlerts=_.reject(h.priceAlerts,function(e){return e.latestNotifications[n]&&e.latestNotifications[n].id==r&&e.itemUUID==i}),nt([P]),Ct(null,{notificationType:n,status:"READ"},null,null,h.profile.profileId+"/vehicles/"+i+"/notifications/"+r),!1}),e(document).on({mouseenter:function(){e(this).removeClass("mycars-action-set").addClass("mycars-action-remove").find(".ui-button-text").html(e(this).attr("label-remove"))},mouseleave:function(){e(this).removeClass("mycars-action-remove").addClass("mycars-action-set").find(".ui-button-text").html(e(this).attr("label-set"))}},".mycars-saved-btn, .mycars-alerts-isset"),I.on("click",".item-compare .checkbox",function(){var t=e(this).closest(".popup");t.find(".item-compare .checkbox:checked").length>1?t.find("[data-mycars-compare-btn]").removeClass("disabled"):t.find("[data-mycars-compare-btn]").addClass("disabled");var i="mycars_compare_"+(e(this).prop("checked")?"check":"uncheck");e(document).trigger("trackEvent",[{widgetName:"MyCars Dropdown Compare Checkbox Click",eventName:i,data:"MyCars Dropdown - "+i}])}),I.find(".mycars-compare-form").submit(function(){var t=e(this);if(t.find("[data-mycars-compare-btn]").hasClass("disabled"))return!1;var i=t.closest(".popup").find(".item-compare .checkbox:checked").map(function(){return e(this).val()}).get().join(",");e.cookie("DDC.inventory-compare.selected",i,{path:"/"}),t.find("input[name=itemIds]").val(i)}),w.find("a").on("click",function(){var n=i.find(".lazy-load");n.size()>0&&(n.removeClass("lazy-load"),e(document).trigger("modulesRefresh",{modules:{ui:t.modules.ui}}))}),w.find("> div").not(".hide-bar").not(i).find("> a").click(function(t){var i=e(this);ei(i.parent(),function(t){t.html()&&t.html()!=u||e.ajax({url:i.attr("href"),success:function(i){t.html("<div>"+i+"</div>"),e(document).trigger("modulesRefresh")},error:function(){t.html(u)},complete:function(){}})},t)}),i.find("> a").click(_.partial(ei,i,function(){i.find(".ui-tabs").tabs("load",0)})),w.find("> .hide-bar > a").click(function(t){t.preventDefault();var i=e(this).closest(".hide-bar"),n=i.hasClass("active");i[n?"removeClass":"addClass"]("active"),b[n?"removeClass":"addClass"]("hideBar"),e("html").hasClass("mycars-toolbar-position-top")||e("html").hasClass("mycars-toolbar-position-top-hidden")?e("html")[n?"removeClass":"addClass"]("mycars-toolbar-position-top-hidden")[n?"addClass":"removeClass"]("mycars-toolbar-position-top"):(e("html").hasClass("mycars-toolbar-position-bottom")||e("html").hasClass("mycars-toolbar-position-bottom-hidden"))&&e("html")[n?"removeClass":"addClass"]("mycars-toolbar-position-bottom-hidden")[n?"addClass":"removeClass"]("mycars-toolbar-position-bottom")}),w.find("> .info .register-link").click(function(){if($("register-link","info"),C.addClass("show-register"),!l){l=!0;var e=d.REGISTER.IMPRESS,t=e.element,i=e.action,n=e.result,r=e.nonInteractive;K({element:t,action:i,result:n,nonInteractive:r})}return Tt(),!1}),w.find("> .info .login-link").click(function(){return $("login-link","info"),C.removeClass("show-register"),Tt(),!1}),I.find(".register-toggle").click(function(t){if(t.preventDefault(),!O&&W)_t("register");else{var i=e(this);if(i.hasClass("show-register"))i.removeClass("show-register").closest(".register-wrapper").find(".register-content").slideUp();else if(i.addClass("show-register").closest(".register-wrapper").find(".register-content").slideDown(),!l){l=!0;var n=d.REGISTER.IMPRESS,r=n.element,a=n.action,s=n.result,o=n.nonInteractive;K({element:r,action:a,result:s,nonInteractive:o})}}}),e(".ua-logged-in .mycars-logout").click(function(){e(".mycars .login .logout").trigger("click"),di()}),T&&("mobile"===t.getUrlParams().favorites&&(t.mobile.slidein.activatePanel("mycars-slidein-panel","right"),e('#mycarsSubnav a[href="#savedTab"]').tab("show")),"mobile"===t.getUrlParams().incentives&&e(".accordion.incentive-list").length&&e("html, body").animate({scrollTop:e(".accordion.incentive-list").offset().top-90},500),e(window.document).on("click","#savedTab .mycars-mobile-list .remove",function(){return $("remove-vehicle","savedCars"),$t(e(this).closest(".mycars-vehicle").data("id")),Ot(D),!1}),e(window.document).on("click",".mycars-mobile-list .mycars-list-row",function(t){if(e(t.target).is("a")===!1&&e(t.target).parent().is("a")===!1&&(e(t.target).is("img")===!1||e(t.target).is("img")&&e(t.target).hasClass("remove"))){var i=e(t.target).closest(".mycars-list-row").find(".vehicle-title a").attr("href");""!==i&&void 0!==i&&(window.open(i,"_self"),t.preventDefault())}}),e(window.document).on("click","#alertsTab .mycars-mobile-list .remove",function(){$("hide-notification","enabledNoficationsCount: "+_.filter(h.savedCars,function(e){return _.has(e.statuses,"NOTIFICATIONS_ENABLED")}).length);var t=e(this).closest(".mycars-vehicle"),i=t.data("id"),n=t.data("notiftype"),r=t.data("notifid");return h.priceAlerts=_.reject(h.priceAlerts,function(e){return e.latestNotifications[n]&&e.latestNotifications[n].id==r&&e.itemUUID==i}),nt([P]),Ct(null,{notificationType:n,status:"READ"},null,null,h.profile.profileId+"/vehicles/"+i+"/notifications/"+r),!1}),e(window.document).on("click",".open-slide-panel",function(t){t.preventDefault();var i=e(this).attr("href");if(!O&&"#registerPanel"==e(this).attr("href")&&W)return _t("register"),!1;if(!O&&"#loginPanel"==e(this).attr("href")&&G)return _t("login"),!1;if(e("#ddc-slidein-panel-mycars-slidein-panel").find(".forgot-password-link, .register-link, .login-link").on("click",function(){V=e(this).closest(".mycars-postform-links").siblings("form").find(".email").val()}),ii(i),"#forgotPasswordPanel"==e(this).attr("href")){var n=e(".forgot-password-form"),r=n.find(".error-text");r.html(""),n.parent().find(".register-sales, .form-group, input").show(),n.find(".password-reset-heading, .password-reset-body").remove(),V&&e("#ddc-slidein-panel-mycars-slidein-panel").find(".section-forgot-password").find(".email").val(V)}else"#registerPanel"==e(this).attr("href")?V&&e("#ddc-slidein-panel-mycars-slidein-panel").find(".section-register").find(".email").val(V):"#loginPanel"==e(this).attr("href")&&V&&e("#ddc-slidein-panel-mycars-slidein-panel").find(".section-login").find(".email").val(V)}),e(window.document).on("click",".mycars-postform-links .forgot-password-link, .mycars-postform-links .register-link, .mycars-postform-links .login-link",function(){"#loginPanel"==e(this).attr("href")?Pt("login"):"#registerPanel"==e(this).attr("href")?Pt("register"):"#forgotPasswordPanel"==e(this).attr("href")&&Pt("login")}),e(window.document).on("click",".section-saved .choose .open-slide-panel",function(){"#loginPanel"==e(this).attr("href")?Pt("login"):"#registerPanel"==e(this).attr("href")&&Pt("register")}),e(window.document).on("click",".close-panel",function(t){t.preventDefault(),e(this).parent().parent().removeClass("active-overlay")}),e(window.document).on("submit",".mycars-form.register-form",function(e){e.preventDefault(),Ft(e)}),e(window.document).on("submit",".mycars-form.login-form",function(e){e.preventDefault(),Lt(e)}),e(window.document).on("click","[data-digital-retail-link-inline-payment]",ui),e(window.document).on("click","[data-digital-retail-link-inline-lifestyle]",ui),e(window.document).on("click","[data-digital-retail-link-inline-testdrive]",ui),e(window.document).on("submit",".mycars-form.forgot-password-form",function(t){t.preventDefault(),xt(t,e(this))}),e(window.document).on("click","#ddc-slidein-panel-mycars-slidein-panel .close-slidein, #ddc-slidein-panel-mycars-slidein-panel .panel-gutter",function(t){t.preventDefault(),e(this).parent().find(".active-overlay").removeClass("active-overlay")}),e(window.document).on("click",".btn-mycars",function(){e('#mycarsSubnav a[href="#savedTab"]').tab("show"),e(window.document).on("click","#ddc-slidein-panel-mycars-slidein-panel :submit",function(t){t.preventDefault();var i=e(this);i.parents("div").hasClass("section-login")&&Lt(t),i.parents("div").hasClass("section-register")&&Ft(t)})}),e(window.document).on("click",".ddc-icon-mycars-viewed.ddc-nav-icon",function(){location.href.indexOf("_autofill")>0&&setTimeout(function(){e("#ddc-slidein-panel-mycars-slidein-panel").find(".login-link").click(),e("#ddc-slidein-panel-mycars-slidein-panel").find(".section-login").find(".email").val("ddcsupport@email.com"),e("#ddc-slidein-panel-mycars-slidein-panel").find(".section-login").find(".password").val("Un1k1tty"),e(window.document).find(".login-form").click(function(e){e.preventDefault(),Lt(e)})},4e3,setTimeout(function(){e('#mycarsSubnav a[href="#toolboxTab"]').tab("show")},2e3,function(){t.mobile.slidein.activatePanel("mycars-slidein-panel","right")}()))})),e(window.document).on("submit",".eprice-form .login-form",function(e){e.preventDefault(),Lt(e,"eprice")}),e(window.document).on("submit",".eprice-form .register-form",function(e){e.preventDefault(),Ft(e,"eprice")}),T||b.on("click input",".register-form:visible,.login-form:visible,.forgot-password-form:visible",function(){var e=this;ti(e)}),function(){e("html").addClass("mycars-logged-out"),e.subscribe("mycars-logged-in",function(){e("html").removeClass("mycars-logged-out"),e("html").addClass("mycars-logged-in")}),e.subscribe("mycars-user-logging-out",function(){e("html").removeClass("mycars-logged-in"),e("html").addClass("mycars-logged-out")})}(),e.subscribe("dr-trade-complete dr-accessories-complete dr-payment-complete dr-finance-complete dr-prequal-complete dr-reserve-complete dr-protect-complete dr-lifestyle-complete dr-testdrive-complete",function(){if(T){var i=e("#ddc-mobile-mycars-toolbox");setTimeout(function(){ni("add-toolbox",i,8e3)},1e3),e('#mycarsSubnav a[href="#toolboxTab"]').tab("show"),e(".notify").on("click.dr-toolbox",function(i){i.preventDefault(),ri(),e(".ddc-document").hasClass("slidein-open-from-right")?t.mobile.slidein.deactivatePanel(function(){t.mobile.slidein.activatePanel("mycars-slidein-panel","right",function(){e('#mycarsSubnav a[href="#toolboxTab"]').tab("show")})}):t.mobile.slidein.activatePanel("mycars-slidein-panel","right")})}si()}),T&&e.subscribe("dr-payment-reset",function(){t.mobile.slidein.deactivatePanel(),e("#ddc-slidein-panel-payment-calc-slidein").remove(),e('[data-name="calculator.payment.dealertrack"]').trigger("click")}),e.subscribe("userProfile-updated",function(){si(),Bt()
}),e.subscribe("mycars-loaded",function(){Bt()}),e.subscribe("dr-inline-opted-out",function(){si()}),"undefined"!=typeof window.DDC.InvData&&window.DDC.pubsub.subscribe("ws-inv-listing-update",function(){X(e(".ws-inv-listing .mycars-btn"))}),e.subscribe("digitalRetailing-updated",function(){t.Widgets.MyCars.ORIGIN_API&&t.Widgets.MyCars.ORIGIN_API.sendUserProfileApiUpdate()})})}(jQuery,window.DDC);